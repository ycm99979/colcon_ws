# This config file is used by ros2_control
controller_manager:
  ros__parameters:
    update_rate: 100  # Hz

    arm_controller:
      type: joint_trajectory_controller/JointTrajectoryController

    gripper_controller:
      type: position_controllers/GripperActionController

    joint_state_broadcaster:
      type: joint_state_broadcaster/JointStateBroadcaster

# Joint State Broadcaster configuration
joint_state_broadcaster:
  ros__parameters:
    joints:
      - actuator2_to_actuator1
      - upperarm_link_to_actuator2
      - actuator3_to_upperarm_link
      - actuator4_to_forearm_link
      - gripper_left_joint
    interfaces:
      - position
      - velocity
      - effort

# Arm Controller - for MoveIt2 integration
arm_controller:
  ros__parameters:
    joints:
      - actuator2_to_actuator1
      - upperarm_link_to_actuator2
      - actuator3_to_upperarm_link
      - actuator4_to_forearm_link
    command_interfaces:
      - position
    state_interfaces:
      - position
      - velocity
    
    # Action server settings
    action_monitor_rate: 20.0  # Hz
    
    # Trajectory execution settings
    allow_partial_joints_goal: false
    allow_integration_in_goal_trajectories: true
    
    # State publishing rate
    state_publish_rate: 50.0  # Hz

    # Tolerances for trajectory execution
    constraints:
      stopped_velocity_tolerance: 0.01  # rad/s
      goal_time: 0.0  # 0 = no time constraint
      
      actuator2_to_actuator1:
        trajectory: 0.1  # rad
        goal: 0.05  # rad
      upperarm_link_to_actuator2:
        trajectory: 0.1
        goal: 0.05
      actuator3_to_upperarm_link:
        trajectory: 0.1
        goal: 0.05
      actuator4_to_forearm_link:
        trajectory: 0.1
        goal: 0.05

# Gripper Controller
gripper_controller:
  ros__parameters:
    joint: gripper_left_joint
    action_monitor_rate: 20.0
    goal_tolerance: 0.001
    max_effort: 100.0
    allow_stalling: false
    stall_velocity_threshold: 0.001
    stall_timeout: 1.0